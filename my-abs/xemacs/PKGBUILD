pkgname=xemacs-stable
pkgver=21.5.27
pkgrel=2
pkgdesc="X Windows version of the Emacs editor"
arch=(i686 x86_64)
makedepends=('libungif' 'xbitmaps')
depends=('db' 'libpng' 'libtiff' 'gpm' 'bash' 'xaw3d')
source=(http://ftp.xemacs.org/pub/xemacs-21.5/xemacs-$pkgver.tar.gz)
url="http://www.xemacs.org/"

build() {
  cd $startdir/src/xemacs-${pkgver}
  ./configure --prefix=/usr \
      --with-x11 --without-postgresql --with-athena=3d \
      --with-database=berkdb --without-ldap \
      --with-menubars=lucid --with-scrollbars=lucid \
      --with-widgets=athena --with-dialogs=athena \
      --with-external-widget \
      --with-jpeg --with-png --with-tiff \
      --with-ncurses --with-pop --with-xfs --without-sound || return 1

  make || return 1
  make autoloads
  
  make prefix="$startdir/pkg/usr" install gzip-el

  rm $startdir/pkg/usr/bin/{b2m,ctags,etags,rcs-checkin}
  rm $startdir/pkg/usr/man/man1/{ctags.1,etags.1}

  # correct permissions
  chown -R root.root $startdir/pkg
}
